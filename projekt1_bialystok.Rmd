```{r}
library(ggplot2)
colnames(T_BIAŁYSTOK) <- c("Rok", "I", "II", "III", "IV","V", "VI", "VII", "VIII", "IX", "X", "XI", "XII" )

```


```{r}
histogram_theme <- theme(axis.title = element_text(family ="sans", size = 20  ),
                         panel.background = element_rect(fill ="gray93"))


for (i in colnames(T_BIAŁYSTOK)[2:13])
{
  print(ggplot(T_BIAŁYSTOK, aes(T_BIAŁYSTOK[,i]))+geom_histogram(fill="gray",color = "black",bins = 8) + labs(x="Temperatura", y="Liczba")
        +histogram_theme)
}
```

```{r}

liniowy_theme <- theme(
  plot.background = element_rect(fill = "#FAF8FF"),
  panel.background = element_rect(fill="gray93"),
  panel.grid = element_line(linewidth = 0.9, color="white"),
  panel.grid.minor = element_line(linewidth = 0.9),
  panel.border = element_rect(linewidth  = 2, fill = NA),
  axis.title = element_text(size = 25, family = "sans"),
  plot.title = element_text(size=30, hjust = 0),
  legend.position  = "none"
  )

#ten kod trzeba wkleić do konsoli, bo z notebooka nie chce generować w oknie
for (i in colnames(T_BIAŁYSTOK)[2:13])
{
  #dev.new() #to jest do tworzenia nowego okna dla każdego wykresu
  print(ggplot(T_BIAŁYSTOK, aes(Rok,T_BIAŁYSTOK[,i]))+ 
          geom_line(color="#B5B5B5",linewidth=0.9) + 
          labs(title=i,x="Rok", y="Temperatura")+ 
          geom_point(aes(colour = T_BIAŁYSTOK[,i], alpha = 0.6), size=3, shape=19) +
          scale_color_gradient(low = "blue", high ="red",limits=c(min(T_BIAŁYSTOK[2:13]),max(T_BIAŁYSTOK[2:13]))) + 
          liniowy_theme)
}

```


```{r}
# STATYSTYKI OPISOWE
tabela_miesiace <- data.frame(rownames=c("Średnia", "Mediana", "Odchylenie Standardowe", "Minimum", "Maximum", "Rozstęp miedzykwartylowy"))

for (i in colnames(T_BIAŁYSTOK[,2:13]))
{
  srednia <- mean(T_BIAŁYSTOK[,i])
  mediana <- median(T_BIAŁYSTOK[,i])
  sd <- sd(T_BIAŁYSTOK[,i])
  min <- min(T_BIAŁYSTOK[,i])
  max <- max(T_BIAŁYSTOK[,i])
  iqr <- IQR(T_BIAŁYSTOK[,i])
  temp_tabela <- data.frame(rownames=c(srednia, mediana,sd, min, max, iqr))
  tabela_miesiace<-cbind.data.frame(tabela_miesiace, temp_tabela)
}
colnames(tabela_miesiace)=c(" ", "I", "II", "III", "IV","V", "VI", "VII", "VIII", "IX", "X", "XI", "XII" )
write.xlsx(tabela_miesiace, 'Tabela_miesiace.xlsx') #TU DAJE OD RAZU DO WORKING DIRECTORY


```

```{r}
boxplot(T_BIAŁYSTOK[,2:13], border="blue", col="orange", main="Rozkład temperatur", xlab="miesiące", ylab="tmp[st.C]")

```

```{r}
#PORY ROKU
wiosna <- data.frame(T_BIAŁYSTOK[,1], round(rowMeans(T_BIAŁYSTOK[,4:6]),3))
lato <- data.frame(T_BIAŁYSTOK[,1], round(rowMeans(T_BIAŁYSTOK[,7:9]),3))
jesien <- data.frame(T_BIAŁYSTOK[,1], round(rowMeans(T_BIAŁYSTOK[,10:12]),3))
zima <- data.frame(T_BIAŁYSTOK[,1], round(rowMeans(T_BIAŁYSTOK[,c(13,2,3)]),3))
wegetacja <-  data.frame(T_BIAŁYSTOK[,1], round(rowMeans(T_BIAŁYSTOK[,5:11]),3))

#lista
dane <- list(wiosna,lato,jesien,zima,wegetacja)
names(dane) <- c("wiosna","lato","jesien","zima","wegetacja")

#zmiana nazw
for (i in 1:5){
  colnames(dane[[i]])<-c("Rok", "Temp")
}
dane

#histogram
histogram <-function(data){
  ggplot(data, aes(data[,2]))+geom_histogram(bins = 8)
  
}
lapply(dane, histogram)

#wykres liniowy
liniowy <- function(data){
          print(ggplot(data, aes(data[,1],data[,2]))+
          geom_line(color="#B5B5B5",linewidth=0.9) + 
          labs(title=i,x="Rok", y="Temperatura")+ 
          geom_point(aes(colour = T_BIAŁYSTOK[,i], alpha = 0.6), size=3, shape=19) +
          scale_color_gradient(low = "blue", high ="red",limits=c(min(data[,2]),max(data[,2]))) + 
          liniowy_theme)
}

sapply(dane, liniowy)

#złożenie średnich w jeden df
pory_roku <- data.frame(wiosna)
for (pora in dane[2:5]) {
  pory_roku <- cbind(pory_roku, pora[,2])
}
colnames(pory_roku) <- c("Rok","wiosna","lato","jesien","zima","wegetacja")

#boxplot
boxplot(pory_roku[2:5], border="blue", col="orange", main="Rozkład średnich temperatur", xlab="pory roku", ylab="tmp[st.C]")
```


```{r}
for (i in colnames(pory_roku[,2:5]))
{
  srednia <- mean(pory_roku[,i])
  mediana <- median(pory_roku[,i])
  sd <- sd(pory_roku[,i])
  min <- min(pory_roku[,i])
  max <- max(pory_roku[,i])
  iqr <- IQR(pory_roku[,i])
  temp_tabela <- data.frame(rownames=c(srednia, mediana,sd, min, max, iqr))
  tabela_pory_roku<-cbind.data.frame(tabela_miesiace, temp_tabela)
}
colnames(tabela_pory_roku)=c(" ", "wiosna","lato","jesien","zima","wegetacja")
write.xlsx(tabela_pory_roku, 'Tabela_pory_roku.xlsx') #TU DAJE OD RAZU DO WORKING DIRECTORY
```

